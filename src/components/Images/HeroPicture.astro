---
import { Picture } from 'astro:assets';
import Credit from '~/components/Images/Credit.astro';

const {
    src,
    widths = [],
    sizes,
    formats = ['avif', 'webp'],
    wrapper = '',
    credit = '',
    ...attrs
} = Astro.props;

const resolvedWidths = widths.length ? widths : [360, 720, 1400, src.width];
const resolvedSizes =
    sizes ||
    `(max-width: 360px) 360px, (max-width: 768px) 720px, (max-width: 1280px) 1400px, ${src.width}px`;

const imageProps = {
    src,
    ...attrs,
    quality: 'high',
    sizes: resolvedSizes,
    widths: resolvedWidths,
    formats,
};
---

{
    wrapper || credit.length ? (
        <div class:list={[wrapper || '', credit && 'group', 'relative']}>
            <Picture {...imageProps} />
            {credit && <Credit {credit} />}
        </div>
    ) : (
        <Picture {...imageProps} />
    )
}
